

<!DOCTYPE html>
<html lang="en">



<head>
<style>

.post {
  background-color: #f5f5f5;
  border-radius: 10px;
  margin-bottom: 20px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  padding: 20px;
  
}

.post.top-post {
  background-color: #fff9e6;
  
}

.post .details {
  display: grid;
  grid-template-columns: max-content 1fr;
  grid-gap: 10px;
  align-items: center;
}
.post .details span.title {
  font-weight: bold;
  font-size: large;
}



.post .details span.value {
  margin-left: 5px;
}
.post .details .left-column {
  grid-column: 1;
}

.post .details .right-column {
  grid-column: 2;
}



.post .section {
  background-color: #fffceb;
  padding: 10px;
  font-weight: bold;
}

.post img {
  width: 100px;
  border-radius: 5px;
}

.post .actions {
  text-align: right;
  margin-top: 10px;
}

.post .actions button {
  margin-left: 5px;
  padding: 5px 10px;
  border-radius: 3px;
  font-size: 14px;
  color: #fff;
  cursor: pointer;
}

.post .actions button.btn-primary {
  background-color: #007bff;
  border: none;
}

.post .actions button.btn-info {
  background-color: #17a2b8;
  border: none;
}

.post .comment-section {
  margin-top: 10px;
}

.post .comment-section textarea {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 5px;
  margin-top: 10px;
}

.post .comment-section button {
  margin-top: 5px;
  padding: 5px 10px;
  border-radius: 3px;
  font-size: 14px;
  color: #fff;
  background-color: #007bff;
  border: none;
  cursor: pointer;
}



/*    gvhgjhilhough            */
.comment-section {
  position: relative;
}

.comment-section textarea {
  padding-right: 40px; /* Adjust the padding to accommodate the button */
}

.comment-section .send-button {
  position: absolute;
  top: 50%;
  right: 10px;
  transform: translateY(-50%);
}




.comment-section {
    display: none;
    margin-top: 10px;
    padding: 10px;
    border: 1px solid #ccc;
  }
  
  .comment-section textarea {
    width: 100%;
    height: 100px;
    margin-bottom: 10px;
  }
  
  .comment-section button {
    float: right;
  }
  
  
.comment {
  margin-bottom: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  padding: 10px;
  background-color: #f5f5f5;
}

.comment-header {
  font-weight: bold;
}

.comment-content {
  margin-top: 5px;
}

/* dfghjttf                   */

.content-wrapper {
    overflow-y: auto;
    height: calc(100vh - 56px); /* Adjust the height as needed */
  }
  
  .content {
    overflow-y: auto;
    height: 100%;
  }
</style>


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lost and Found System</title>


  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
  <!-- DataTables -->
  <link rel="stylesheet" href="plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
  <link rel="stylesheet" href="plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/adminlte.min.css">

<body class="hold-transition sidebar-mini">
<div class="wrapper">
  <!-- Navbar -->
   <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
    
    </ul>



    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <!-- Messages Dropdown Menu -->
      
      <!-- Notifications Dropdown Menu -->

      <li class="nav-item">
        <a class="nav-link" data-widget="fullscreen" href="#" role="button">
          <i class="fas fa-expand-arrows-alt"></i>
        </a>
      </li>
     
    </ul>
  </nav>
  <!-- /.navbar -->

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="" class="brand-link">
      <img src="dist/img/logo.jpg" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
      <span class="brand-text font-weight-light">Lost and Found</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Sidebar user panel (optional) -->
   <div class="user-panel mt-3 pb-3 mb-3 d-flex">
        <div class="image">
          <img src="dist/img/avatar.png" id="userimage" class="img-square elevation-3" style="width:30px;  border-radius:10%;" alt="User Image">        
        
        </div>
    
    <div class="info">
          <a id="name" class="d-block" style="margin-top: -12px">Junio K. Krem</a>
         <a href="#" style="color: #239db1; font-size: 15px"><i class="fa fa-circle text-primary" style="font-size: 13px;"></i> Member</a>
        </div>

      </div>

      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
          <li class="nav-item menu-open">
            <a href="User Main DashBoard.html" class="nav-link active">
              <i class="nav-icon fas fa-briefcase"></i>
              <p>
                Lost and Found Item
              </p>
            </a>
          </li>
          <li class="nav-item">
            <a href="report.html" class="nav-link">
              <i class="nav-icon fas fa-book"></i>
              <p>
                Report
              </p>
            </a>
          </li>
           <li class="nav-item">
            <a href="../Log in/USER.html" class="nav-link">
              <i class="nav-icon fas fa-power-off"></i>
              <p>
                Logout
              </p>
            </a>
          </li>
      </nav>
      <!-- /.sidebar-menu -->
    </div>
    <!-- /.sidebar -->
  </aside>
  <!-- Content Wrapper. Contains page content -->









  <div class="content-wrapper" style="overflow-x: auto;">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>Lost and Found Item</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Lost and Found Item</li>
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid" style="overflow-x: auto;">
        <div class="row">
          <div class="col-12">
       

            <div class="card" style="overflow-x: auto; overflow-y: auto;">
              
             
              <!-- /.card-header -->
              
              <div class="d-flex justify-content-center" style="overflow-x: auto; border-radius: 60px;">
               
               
                <table id="dataTable" class="table table-bordered table-striped" style="overflow-y: auto; width: 900px; margin-top: 60px; border-color: yellow;">
                  <thead>
                    <!-- Add your table header row here -->
                  </thead>
                  <tbody id="tableBody" style="background-color: rgb(97, 95, 95);">
                    <!-- Add your table rows here -->
                  </tbody>
                </table>
                
                
                
                
                    
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
      </div>
      
      <!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->


  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->

<!-- jQuery -->

<script src="plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- DataTables  & Plugins -->

<script src="plugins/jszip/jszip.min.js"></script>
<script src="plugins/pdfmake/pdfmake.min.js"></script>
<script src="plugins/pdfmake/vfs_fonts.js"></script>
<script src="dist/js/adminlte.min.js"></script>
<!-- AdminLTE App -->


<!-- Page specific script -->
<script>
  $(document).ready(function() {
  $('#dataTable').DataTable();
});


</script>

<script>
  
  
  

  // Get the value from session storage
  const myText = sessionStorage.getItem("name");
const imageName = sessionStorage.getItem("image");


if (imageName) {
  var imagePath = "../Register/RegisterImage/" + imageName;
  var imgElement = document.getElementById("userimage");
  imgElement.src = imagePath;
} else {

  console.error("Image name is not available in session storage.");
}

  var myParagraph = document.getElementById("name");
  myParagraph.innerHTML = myText;
  sessionStorage.setItem("name", myText);
  sessionStorage.setItem("image", imagename);

  </script>
  <script>

var count=1;
window.onload = function() {
        // Call your function here
        getblog();
count=1;
      };
      function getblog() {
  var id = $("#id5").val();
  $.ajax({
    url: 'http://localhost:4000/GetReport',
    headers: {
      'Content-Type': 'application/json'
    },
    type: 'GET',
    success: function(results) {
      // Clear any existing posts
      $("#tableBody").empty();
      var count = 1;
      // Iterate over the results array and add a post for each object
      results.forEach(function(result) {
  // Create a new post
  var post = $("<div></div>").addClass("post");

  // Add the post details
  var topPost = $("<div></div>").addClass("post top-post");

var postSection = $("<div></div>").addClass("section").text("Posted By: " + result.username);
topPost.append(postSection);
post.append(topPost);

  var body = $("<div></div>").addClass("body");

  var table = $("<table></table>").css({"width": "100%","border-radius": "10px"});

var tbody = $("<tbody></tbody>");
var headerRow = $("<tr></tr>");

// Create a table header cell spanning two columns
var headerCell = $("<th></th>").attr("colspan", "2").text("Contact details").css({"text-align": "center","background-color": "lightyellow"});

// Append the header cell to the header row
headerRow.append(headerCell);

// Append the header row to the table body
tbody.append(headerRow);
// Create a table row for the first title and value
var row = $("<tr></tr>");

// Create the first column (title)
var titleColumn = $("<td></td>").text("Name: ").css("font-weight", "bold").css("width", "160px");

// Create the second column (value)
var valueColumn = $("<td></td>").text(result.Name).css("margin-left", "20px");

// Append the columns to the row
row.append(titleColumn, valueColumn);

// Append the row to the table body
tbody.append(row);

// Repeat the above steps for the other title and value pairs

// Second title and value
row = $("<tr></tr>");
titleColumn = $("<td></td>").text("Email: ").css("font-weight", "bold");
valueColumn = $("<td></td>").text(result.Email).css("margin-left", "20px");
row.append(titleColumn, valueColumn);
tbody.append(row);

// Third title and value
row = $("<tr></tr>");
titleColumn = $("<td></td>").text("Phone: ").css("font-weight", "bold");
valueColumn = $("<td></td>").text(result.Phone).css("margin-left", "20px");
row.append(titleColumn, valueColumn);
tbody.append(row);

var row = $("<tr></tr>");
titleColumn = $("<td></td>").text("ID: ").hide();
valueColumn = $("<td></td>").addClass("post-id").text(result.ID).hide();
row.append(titleColumn, valueColumn);
tbody.append(row);


// Append the table body to the table
table.append(tbody);

// Append the table to the desired element (e.g., the table body)
$(table).appendTo(body);


  // Create the right column for other details
  

  // Create a table element
  var table = $("<table></table>").css({ "width": "100%", "margin-top": "5px", "border-radius": "30px" });

// Create a table body element
var tbody = $("<tbody></tbody>");

// Create a table header row
var headerRow = $("<tr></tr>");

// Create a table header cell spanning two columns
var headerCell = $("<th></th>").attr("colspan", "2").text("Things Details").css({"text-align": "center","background-color": "lightyellow"});

// Append the header cell to the header row
headerRow.append(headerCell);

// Append the header row to the table body
tbody.append(headerRow);

// Create a table row for the ID (hidden)


// Create a table row for the "Found/Lost" title and value
var foundLostRow = $("<tr></tr>");
var foundLostTitleColumn = $("<td></td>").text("Found/Lost: ").css("font-weight", "bold").css("width", "160px");
var foundLostValueColumn = $("<td></td>").text(result.Type).css("margin-left", "20px");
foundLostRow.append(foundLostTitleColumn, foundLostValueColumn);
tbody.append(foundLostRow);

// Repeat the above steps for the other title and value pairs

// Item
var itemRow = $("<tr></tr>");
var itemTitleColumn = $("<td></td>").text("Item: ").css("font-weight", "bold");
var itemValueColumn = $("<td></td>").text(result.ItemName).css("margin-left", "20px");
itemRow.append(itemTitleColumn, itemValueColumn);
tbody.append(itemRow);

// Location
var locationRow = $("<tr></tr>");
var locationTitleColumn = $("<td></td>").text("Location: ").css("font-weight", "bold");
var locationValueColumn = $("<td></td>").text(result.Location_Name).css("margin-left", "20px");
locationRow.append(locationTitleColumn, locationValueColumn);
tbody.append(locationRow);

// Date
var dateRow = $("<tr></tr>");
var dateTitleColumn = $("<td></td>").text("Date: ").css("font-weight", "bold");
var dateValueColumn = $("<td></td>").text(result.Date_).css("margin-left", "20px");
dateRow.append(dateTitleColumn, dateValueColumn);
tbody.append(dateRow);

// Time
var timeRow = $("<tr></tr>");
var timeTitleColumn = $("<td></td>").text("Time: ").css("font-weight", "bold");
var timeValueColumn = $("<td></td>").text(result.Time_).css("margin-left", "20px");
timeRow.append(timeTitleColumn, timeValueColumn);
tbody.append(timeRow);

// Further Details
var detailsRow = $("<tr></tr>");
var detailsTitleColumn = $("<td></td>").text("Further Details: ").css("font-weight", "bold");
var detailsValueColumn = $("<td></td>").text(result.Description).css("margin-left", "20px");
detailsRow.append(detailsTitleColumn, detailsValueColumn);
tbody.append(detailsRow);

// Is Anyone Applied?
var appliedRow = $("<tr></tr>");
var appliedTitleColumn = $("<td></td>").text("Is Anyone Applied?: ").css("font-weight", "bold");
var appliedValueColumn = $("<td></td>").text(result.IsApplied).css("margin-left", "20px");
appliedRow.append(appliedTitleColumn, appliedValueColumn);
tbody.append(appliedRow);

// Append the table body to the table
table.append(tbody);

// Append the table to the desired element (e.g., the table body)
$(table).appendTo(body);


  body.appendTo(post);

  // Create the image element and set its source dynamically
  var image = $("<img>").attr("src", "upload/" + result.Image);
  image.appendTo(post);

  // Add the post remarks
  $("<div></div>").addClass("description").text("").appendTo(post);

  var actions1 = $("<div></div>").addClass("actions d-flex justify-content-end");

var Apply = $("<button></button>")
  .addClass("btn btn-primary btn-sm")
  .text("Apply Now")
  .click(function() {
    applyformything(this);
    $(this)
      .removeClass("btn-primary")
      .addClass("btn btn-info")
      .text("Applied"); // Change button color to green and update text to "Applied" (assuming 'btn-success' class represents the desired color)
  });

actions1.append(Apply);
actions1.appendTo(post);

  

  // Create the actions section and append the comment button
var actions = $("<div></div>").addClass("actions");
var commentButton = $("<button></button>").addClass("btn btn-primary btn-sm").click(function() {
  showCommentSection(this);
});
var icon = $("<i></i>").addClass("fa fa-comment");
commentButton.append(icon);
actions.append(commentButton);
actions.appendTo(post);

// Add the comment section
var commentSection = $("<div></div>").addClass("comment-section");
var commentTextarea = $("<textarea></textarea>").attr("placeholder", "Add a comment...").appendTo(commentSection);
var commentButton = $("<button></button>").addClass("btn btn-primary").click(function() {
  postComment(this);
});
var sendIcon = $("<i></i>").addClass("fa fa-send");
commentButton.append(sendIcon);
commentSection.append(commentTextarea, commentButton);
post.append(commentSection); // Append commentSection to the post element


  // Add the post to the table body
  $("#tableBody").append(post);
  count++;
});










        // Show the table
        $("#example1").show();
      },
      error: function () {
        alert('An error occurred');
      }
    });
  }

  function applyformything(button) {

    var postId = $(button).closest(".post").find(".post-id").text();

$.ajax({
      url: "http://localhost:4000/isApplied", // Replace with your actual API endpoint
      method: "POST",
      data: { postId: postId },
      success: function(response) {
        // Handle the successful response from the server, if needed
       
      },
      error: function(xhr, status, error) {
        // Handle any errors that occurred during the request, if needed
        console.error("Error posting comment:", error);
      }
    });

  }

  function showCommentSection(button) {
  var postId = $(button).closest(".post").find(".post-id").text();
  var commentSection = $(button).closest(".post").find(".comment-section");

  commentSection.slideToggle(function() {
    // Callback function after slideToggle completes
    if (commentSection.is(":visible")) {
      // Comment section is now visible, load the comments
      loadComments(postId, button);
    }
  });
}

function postComment(button) {
  var commentTextarea = $(button).siblings("textarea");
  var commentText = commentTextarea.val().trim();

  var userName = $("#name").text();
  var postId = $(button).closest(".post").find(".post-id").text();

  if (commentText !== "") {
    // Create a data object with the comment details
    var commentData = {
      postId: postId,
      userName: userName,
      commentText: commentText
    };

    // Send the comment data to the server using AJAX or any other method
    $.ajax({
      url: "http://localhost:4000/sendcomment", // Replace with your actual API endpoint
      method: "POST",
      data: commentData,
      success: function(response) {
        // Handle the successful response from the server, if needed
        var comment = $("<div></div>").addClass("comment");
    var commentHeader = $("<div></div>").addClass("comment-header").text(userName + "  :  ");
    var commentContent = $("<div></div>").addClass("comment-content").text(commentText);

    comment.append(commentHeader, commentContent);
    comment.insertBefore(commentTextarea);
    commentTextarea.val("");
      },
      error: function(xhr, status, error) {
        // Handle any errors that occurred during the request, if needed
        console.error("Error posting comment:", error);
      }
    });

    // Display the comment on the page
    
  }
}



function loadComments(postId, button) {
  // AJAX function to retrieve comments for a specific post
  console.log("Fetching comments for postId:", postId);
  $.ajax({
    url: "http://localhost:4000/GetComment",
    method: "GET",
    data: { postId: postId },
    success: function(response) {
      // Handle the successful response from the server
      var commentSection = $(button).closest(".post").find(".comment-section");
      commentSection.empty();

      if (response && response.length > 0) {
        response.forEach(function(comment) {
          var commentElement = $("<div></div>").addClass("comment");
          var commentHeader = $("<div></div>").addClass("comment-header").text(comment.name + "  :  ");
          var commentContent = $("<div></div>").addClass("comment-content").text(comment.comment);

          commentElement.append(commentHeader, commentContent);
          commentSection.append(commentElement);
        });
      } else {
        var noCommentMessage = $("<div></div>").addClass("no-comment").text("No comments yet.");
        commentSection.append(noCommentMessage);
      }

      // Append the textarea for posting comments
      var commentTextarea = $("<textarea></textarea>").attr("placeholder", "Add a comment...");
      var commentButton = $("<button></button>").addClass("btn btn-primary").text("Post Comment").click(function() {
        postComment(this);
      });
      var commentForm = $("<div></div>").addClass("comment-form").append(commentTextarea, commentButton);
      commentSection.append(commentForm);
    },
    error: function(xhr, status, error) {
      // Handle any errors that occurred during the request, if needed
      console.error("Error retrieving comments:", error);
    }
  });
}





  </script>
</body>
</html>
