

<!DOCTYPE html>
<html lang="en">

<style>
/* Hide the input element */
#file-upload {
  display: none;
}

/* Show the file name label when a file is selected */
#file-upload:not(:empty) + #file-name {
  display: inline-block;
}

/* Style the file name label */
#file-name {
  margin-left: 10px;
  font-size: 16px;
}

.custom-file-upload {
  display: inline-block;
  background-color: #777c96;
  color: #fff;
  border: none;
  border-radius: 9px;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
  width: 100%;
  text-align: center; /* add this line */
}


</style>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lost and Found System</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/adminlte.min.css">
  <link rel="stylesheet" href="plugins/summernote/summernote-bs4.min.css"> 
</head>
<body class="hold-transition sidebar-mini">
<div class="wrapper">
  <!-- Navbar -->
   <!-- Navbar -->
   <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
    
    </ul>



    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <!-- Messages Dropdown Menu -->
      
      <!-- Notifications Dropdown Menu -->

      <li class="nav-item">
        <a class="nav-link" data-widget="fullscreen" href="#" role="button">
          <i class="fas fa-expand-arrows-alt"></i>
        </a>
      </li>
     
    </ul>
  </nav>
  <!-- /.navbar -->

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="" class="brand-link">
      <img src="dist/img/logo.jpg" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
      <span class="brand-text font-weight-light">Lost and Found</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Sidebar user panel (optional) -->
   <div class="user-panel mt-3 pb-3 mb-3 d-flex">
        <div class="image">
    <img src="dist/img/avatar.png" id="userimage" class="img-square elevation-3" style="width:30px;  border-radius:10%;" alt="User Image">        </div>
        <div class="info">
          <a id="name" href="#" class="d-block" style="margin-top: -12px">Junio K. Krem</a>
         <a href="#" style="color: #239db1; font-size: 15px"><i class="fa fa-circle text-primary" style="font-size: 13px;"></i> Member</a>
        </div>

      </div>

      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
          <li class="nav-item">
            <a href="User Main DashBoard.html" class="nav-link">
              <i class="nav-icon fas fa-briefcase"></i>
              <p>
                Lost and Found Item
              </p>
            </a>
          </li>
          <li class="nav-item menu-open">
            <a href="report.html" class="nav-link active">
              <i class="nav-icon fas fa-book"></i>
              <p>
                Report
              </p>
            </a>
          </li>
           <li class="nav-item">
            <a href="../Log in/USER.html" class="nav-link">
              <i class="nav-icon fas fa-power-off"></i>
              <p>
                Logout
              </p>
            </a>
          </li>
        </ul>
      </nav>
      <!-- /.sidebar-menu -->
    </div>
    <!-- /.sidebar -->
  </aside>
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <form id="uploadForm"  enctype="multipart/form-data">

    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>Report Lost and Found Item</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Report</li>
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>






    
    <!-- Main content -->
    <section class="content" >
      <div class="container-fluid"  >
        <div class="row">
     
          <div class="col-md-8" style="margin-left: 18%">
            <div class="card">
              <div class="card-header p-2" align-text="center">
              <h4>Report Submission Form</h4>
              </div><!-- /.card-header -->
              <div class="card-body" style="background-color: #f7f3e6">
                <div class="tab-content" >
                  <div class="active tab-pane" id="activity" >

                    <!-- Post -->
                    <div class="post">
                      <form class="form-horizontal"  >




                        <div class="row">
                          <div class="col-4" style="margin-top: 3%">
                              <label>Date:</label>
                          <input id="date3" name="date" type="date" class="form-control" placeholder=".col-5">
                        </div>
                         <div class="col-5">
                         </div>
                        <div class="col-3" style="margin-top: 3%">
                          <label>Time:</label>
                          <input type="time" name="time" id="time" class="form-control" placeholder=".col-5">
                        </div>
                            <div class="col-12" style="margin-top: 3%">
                            <div class="form-group" >
                              <select class="form-control" name="type" id="type">
                                <option disabled="" selected="">Post Type</option>
                                <option>Found Item</option>
                                <option>Lost Item</option>
                              </select>
                            </div>
                          </div>
                        <div class="col-12"  >
                          <input type="text" id="itemname" name="itemname" class="form-control" placeholder="Item Name">
                        </div>
                        <div class="col-12" style="margin-top: 3%">
                          <textarea class="form-control" name="description" id="description" rows="2" placeholder=" Item Description ..."></textarea>
                        </div>


                        
                         
                          <div class="col-12" style="margin-top: 3%">
                            <input type="text" id="name3" name="name" class="form-control" placeholder="Name">
                        </div>
                        <div class="col-12" style="margin-top: 3%">
                          <input type="email" id="email" name="email" class="form-control" placeholder="Email">
                        </div>
                        <div class="col-12" style="margin-top: 3%">
                          <input type="text" id="phone" name="phone" class="form-control" placeholder="Phone">
                        </div>



                         <div class="col-4" style="margin-top: 3%">
                          <label for="exampleInputEmail1">Upload Image</label>
                         
                          <input class="form-control" type="file" name="image" id="uploadFile">

                        </div>

                        <div class="col-12" style="margin-top: 3%">
                          <div id="map"  style="width: auto;height:200px;"></div>
                                     <input type="hidden" name="lat" id="lat" />
                                                    <input type="hidden" name="long" id="long" />
                        </div>

                        <div class="col-6" style="margin-top: 3%">
                          <input type="text"  id="pac-input" name="locationname"  class="form-control" placeholder="Location..">
                          <input type="text" name="username" id="usernameField" style="display: none;">
                        </div>

                        <div class="col-6" style="margin-top: 3%">
                          
                          <input id="location" type="button" onclick= "getLocation()" class="form-control" style="background-color: #777c96; color: #fff;" value="Get live Location">

                          
                        </div>
                        <div class="col-12" style="margin-top: 3%" >
                         
                          
                           
                        
                        
                        </div>
                      </div>



                    
                      <div class="form-group row" style="margin-top: 3%">
                          
                      <input type="myButton" onclick="myname()" value="Submit" class="btn btn-info btn-sm" style="margin-left: 25%; margin-top: 1%; width: 50%; height: 40px;" >
                        </div>
                    </form>
                      </div>
                  </div>
                </div>
                <!-- /.tab-content -->
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
      </div><!-- /.container-fluid -->
    </section>


    



</form>

    <!-- /.content -->
  </div>
  <footer class="main-footer">
    <strong>Footer <a href="">Lost and Found System</a>.</strong>
    All rights reserved.
    <div class="float-right d-none d-sm-inline-block">
      <b>Footer</b>
    </div>
  </footer>
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->

<!-- jQuery -->
<script src="plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->

<script src="plugins/summernote/summernote-bs4.min.js"></script>



<script>


const myText = sessionStorage.getItem("name");
const imageName = sessionStorage.getItem("image");


if (imageName) {
  var imagePath = "../Register/RegisterImage/" + imageName;
  var imgElement = document.getElementById("userimage");
  imgElement.src = imagePath;
} else {
  // Handle the case when the image name is not available
  console.error("Image name is not available in session storage.");
}
  var myParagraph = document.getElementById("name");
  var usernameInput = document.getElementById("usernameField");
  usernameInput.value = myText; 
  myParagraph.innerHTML = myText;
  sessionStorage.setItem("name", username);
  sessionStorage.setItem("image", imagename);
</script>

<script>
	
	
	
	
  


  var map;
  
  function initAutocomplete() {                            
  
      var map = new google.maps.Map(document.getElementById('map'), {
        center : {
          lat : 30.3753,
          lng : 69.3451
        },
        zoom : 5
      });
    
    
       var options = {
        componentRestrictions: {country: "pk"}
       };		
      
      var input = (document.getElementById('pac-input'));
      var autocomplete = new google.maps.places.Autocomplete(input, options);
  
      autocomplete.bindTo('bounds', map);
  
      var infowindow = new google.maps.InfoWindow();
      
      var marker = new google.maps.Marker({
        draggable:true,
        map : map
        
      });
        
  
      autocomplete.addListener('place_changed', function() {
  
        var place = autocomplete.getPlace();
        var lattitude = place.geometry.location.lat();
        var longitude = place.geometry.location.lng();
        
  google.maps.event.addListener(marker, 'dragend', function (event) {
      document.getElementById("lat").value = this.getPosition().lat();
      document.getElementById("long").value = this.getPosition().lng();
    
    //Marker Location Changed
    
    document.getElementById("lat").value = this.getPosition().lat();
    
    
    document.getElementById("long").value = this.getPosition().lng();
    
    
  });				
  
        //alert(lattitude + ' ' + longitude);
        document.getElementById("lat").value = lattitude;
        document.getElementById("long").value = longitude;
        
        
        //Selected Place Changed
        
        //alert("Hello");
  
        infowindow.close();
        marker.setVisible(false);
        var place = autocomplete.getPlace();
        if (!place.geometry) {
          window.alert("Autocomplete's returned place contains no geometry");
          return;
        }
  
        // If the place has a geometry, then present it on a map.
        if (place.geometry.viewport) {
          map.fitBounds(place.geometry.viewport);
        } else {
          map.setCenter(place.geometry.location);
          map.setZoom(17);
          // Why 17? Because it looks good.
        }
  
        marker.setPosition(place.geometry.location);
        marker.setVisible(true);
  
        var address = '';
        if (place.address_components) {
          address = [(place.address_components[0] && place.address_components[0].short_name || ''), (place.address_components[1] && place.address_components[1].short_name || ''), (place.address_components[2] && place.address_components[2].short_name || '')].join(' ');
        }
  
        infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
        infowindow.open(map, marker);
  
  
  
        // iterate through address_component array
  
  
  
      });
        
  }	


  function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else {
    alert("Geolocation is not supported by this browser.");
  }
}

function showPosition(position) {
  var lat = position.coords.latitude;
  var long = position.coords.longitude;

  document.getElementById("lat").value = lat;
  document.getElementById("long").value = long;

  var apiKey="AIzaSyB9irjntPHdEJf024h7H_XKpS11OeW1Nh8&libraries=places&callback";

const apiUrl = `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${long}&key=${apiKey}`;

// Make a request to the API
fetch(apiUrl)
.then(response => response.json())
.then(data => {
// Get the location name from the API response
const locationName = data.results[0].formatted_address;

document.getElementById("pac-input").value=locationName;
// Do something with the location name, e.g. display it in the console

});


  if (!map) {
    var map = new google.maps.Map(document.getElementById('map'), {
      center: {
        lat: lat,
        lng: long
      },
      zoom: 15
    });

    var marker = new google.maps.Marker({
      draggable: true,
      map: map,
      position: {
        lat: lat,
        lng: long
      }
    });

    google.maps.event.addListener(marker, 'dragend', function(event) {
      document.getElementById("lat").value = this.getPosition().lat();
      document.getElementById("long").value = this.getPosition().lng();

      //Marker Location Changed

     var lat1= document.getElementById("lat").value = this.getPosition().lat();


     var lon1= document.getElementById("long").value = this.getPosition().lng();

          

          var apiKey="AIzaSyB9irjntPHdEJf024h7H_XKpS11OeW1Nh8&libraries=places&callback";

      const apiUrl = `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat1},${lon1}&key=${apiKey}`;

// Make a request to the API
     fetch(apiUrl)
     .then(response => response.json())
   .then(data => {
    // Get the location name from the API response
    const locationName = data.results[0].formatted_address;
        document.getElementById("pac-input").value=locationName;
    // Do something with the location name, e.g. display it in the console
    
  });

    });
  } else {
    var center = new google.maps.LatLng(lat, long);
    map.panTo(center);
    marker.setPosition(center);



    
    
  }
}





  
      </script>
  
  
          <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB9irjntPHdEJf024h7H_XKpS11OeW1Nh8&libraries=places&callback=initAutocomplete"
          async defer></script>


          <script>

            


    function myname() {
   

    var data = new FormData($('#uploadForm')[0]);
    $.ajax({
        url: 'http://localhost:4000/insert5',
        type: 'POST',
        contentType: false,
        processData: false,
        cache: false,
        data: data,
        success: function(res) {
            alert("Data Inserted");
        },
            error: function(){
                alert('Error: In sending the request!');
            }
        
    });
}

document.getElementById("myButton").addEventListener("click", myname);

  </script>

  
</body>
 </html>
